import{m as f}from"./axios-bee2a5fc.js";import{bE as U,bG as L,bV as N,bH as j,c7 as E,bJ as M,c8 as A,bX as G,bP as H,a as e,b_ as R,o as d,c as m,w as s,b as o,l as _,e as c,t as u,j as g,F as k,f as C,d as T,V as S,aw as J,au as $,aP as z,aM as K}from"./main-a77e6c06.js";import{_ as O}from"./_plugin-vue_export-helper-c27b6911.js";import{V,a as X,c as w,b as q}from"./VCard-20a9eae2.js";import{V as Q}from"./VDivider-3de21679.js";import{a as W,V as Y}from"./VChip-35917e72.js";import{V as x}from"./VSpacer-98202bbe.js";import{V as D}from"./VForm-92d3a285.js";import{V as v,a as y}from"./VRow-e3142850.js";import{V as I}from"./VTextarea-16555369.js";import{V as Z,a as ee,b as P,c as B}from"./VMenu-cba6081d.js";import{V as te}from"./VDialog-905ca638.js";import"./VAvatar-e08905f9.js";import"./VImg-6deedc66.js";import"./index-b3ccc4ba.js";import"./VCounter-a201745a.js";import"./VOverlay-07dc9b4f.js";import"./dialog-transition-cf202ca1.js";const ae=U({fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,...L(),...N(),...j(),...E()},"v-table"),se=M()({name:"VTable",props:ae(),setup(t,a){let{slots:r}=a;const{themeClasses:F}=A(t),{densityClasses:l}=G(t);return H(()=>e(t.tag,{class:["v-table",{"v-table--fixed-height":!!t.height,"v-table--fixed-header":t.fixedHeader,"v-table--fixed-footer":t.fixedFooter,"v-table--has-top":!!r.top,"v-table--has-bottom":!!r.bottom,"v-table--hover":t.hover},F.value,l.value,t.class],style:t.style},{default:()=>{var n,i,p;return[(n=r.top)==null?void 0:n.call(r),r.default?e("div",{class:"v-table__wrapper",style:{height:R(t.height)}},[e("table",null,[r.default()])]):(i=r.wrapper)==null?void 0:i.call(r),(p=r.bottom)==null?void 0:p.call(r)]}})),{}}}),oe={data(){return{detail:{},fileId:this.$route.params.fileId,fileUser:this.$userPhotoUrl,filePath:this.$filePath,comments:null,dataForm:{id:null,file_uuid:this.$route.params.fileId,desc:null,descupdate:null},edit:!1}},methods:{goBack(){this.$router.go(-1)},formatDate(t){return new Date(t).toLocaleDateString("id-ID")},async getDetailFile(t){try{const a=await f.get(`/file/${t}`);a.status===200?this.detail=a.data.data:this.$showToast("error","Sorry",a.data.data.message)}catch(a){this.$showToast("error","Sorry",a.response.data.data.message)}},resetForm(){this.dataForm={id:null,file_uuid:this.$route.params.fileId,desc:null,descupdate:null}},async getCommentFile(t){try{const a=await f.get(`/comment/${t}`);this.comments=a.data.data.map(r=>({id:r.uuid,content:r.desc,user_type:r.user.isAdmin,name:r.user.name,position:r.user.position.name,created_at:r.created_at}))}catch(a){const r=a.response&&a.response.data&&a.response.data.message?a.response.data.message:"Gagal login. Silakan coba lagi.";this.$showToast("error","Sorry",r)}},async insertCommentar(){try{this.dataForm.desc===null&&this.$showToast("error","Sorry","komentar kosong");const t=new FormData;t.append("file_uuid",this.dataForm.file_uuid),t.append("desc",this.dataForm.desc),t.append("_method","POST");const a=await f.post("/comment",t);a.status===200?(this.resetForm(),this.getCommentFile(this.fileId),this.$showToast("success","Success",a.data.message)):this.$showToast("error","Sorry",a.data.message)}catch(t){this.$showToast("error","Sorry",t.response.data.message)}},async deleteComment(t){try{if(!window.confirm("Apakah Anda yakin ingin menghapus comment?"))return;const r=await f.delete(`/comment/${t}`);r.status===200?(this.getCommentFile(this.fileId),this.$showToast("success","Berhasil",r.data.message)):this.$showToast("error","Sorry",r.data.message)}catch(a){this.$showToast("error","Sorry",a.response.data.message)}},popupEdit(t){this.dataForm.id=t.id,this.dataForm.descupdate=t.content,this.edit=!0},async updateComment(){try{const t=new FormData;t.append("desc",this.dataForm.descupdate),t.append("_method","PUT");const a=await f.post(`/comment/${this.dataForm.id}`,t);a.status===200?(this.resetForm(),this.getCommentFile(this.fileId),this.edit=!1,this.$showToast("success","Success",a.data.message)):this.$showToast("error","Sorry",a.data.message)}catch(t){this.$showToast("error","Sorry",t.response.data.message)}}},mounted(){this.getDetailFile(this.fileId),this.getCommentFile(this.fileId)}},h=t=>(z("data-v-91795b78"),t=t(),K(),t),re=h(()=>o("td",null,"Nama File",-1)),le=h(()=>o("td",null,":",-1)),ie=h(()=>o("td",null,"Deskripsi Singkat",-1)),ne=h(()=>o("td",null,":",-1)),de={key:0},me=h(()=>o("td",null,"Pengunggah",-1)),ue=h(()=>o("td",null,":",-1)),ce={class:"row d-flex align-center"},he={key:0,class:"player-wrapper"},pe=["src","alt"],fe={key:1},_e={key:1},ge=h(()=>o("td",null,"Jabatan",-1)),ye=h(()=>o("td",null,":",-1)),be={class:"row d-flex align-center"},Ve=["src"],we={class:"mt-3"},ve={class:"comment-content"};function Fe(t,a,r,F,l,n){return d(),m("div",null,[e(V,{class:"auth-card pa-4 pt-5"},{default:s(()=>[e(X,{class:"align-left"},{default:s(()=>[o("span",{color:"primary",onClick:a[0]||(a[0]=(...i)=>n.goBack&&n.goBack(...i)),style:{cursor:"pointer"}},[e(_,{icon:"bx-arrow-back",color:"primary",tag:"back",start:""}),c(" Back ")]),e(w,{class:"text-2xl font-weight-bold"},{default:s(()=>[c(" Detail "+u(l.detail.name??"-"),1)]),_:1}),e(Q,{inset:""}),e(se,null,{default:s(()=>[o("tbody",null,[o("tr",null,[re,le,o("td",null,u(l.detail.name),1)]),o("tr",null,[ie,ne,o("td",null,u(l.detail.summary),1)]),l.detail.author?(d(),m("tr",de,[me,ue,o("td",null,[o("div",ce,[l.detail.author.photo?(d(),m("div",he,[o("img",{class:"avator",src:l.fileUser+l.detail.author.photo,alt:l.detail.name,width:60},null,8,pe)])):g("",!0),l.detail.author.name?(d(),m("span",fe,u(l.detail.author.name),1)):g("",!0)])])])):g("",!0),l.detail.positions?(d(),m("tr",_e,[ge,ye,o("td",null,[o("div",be,[e(W,{"selected-class":"text-primary",column:""},{default:s(()=>[(d(!0),m(k,null,C(l.detail.positions,(i,p)=>(d(),m("div",{key:p},[e(Y,{style:{color:"rgb(6, 84, 107)"}},{default:s(()=>[c(u(i.name),1)]),_:2},1024)]))),128))]),_:1})])])])):g("",!0)])]),_:1}),o("div",null,[o("iframe",{width:"100%",height:"500px",src:l.filePath+l.detail.path,frameborder:"0",allowfullscreen:""},null,8,Ve)]),e(x),o("div",we,[e(V,{class:"mx-auto"},{default:s(()=>[e(w,null,{default:s(()=>[c(" Komentar ")]),_:1}),e(w,null,{default:s(()=>[e(D,{onSubmit:T(n.insertCommentar,["prevent"])},{default:s(()=>[e(v,{align:"center",justify:"center"},{default:s(()=>[e(y,{md:"10",cols:"10"},{default:s(()=>[e(I,{"bg-color":"grey-lighten-2",color:"cyan",modelValue:l.dataForm.desc,"onUpdate:modelValue":a[1]||(a[1]=i=>l.dataForm.desc=i)},null,8,["modelValue"])]),_:1}),e(y,{md:"2",cols:"2"},{default:s(()=>[e(S,{density:"compact",icon:"mdi-note-plus",type:"submit"})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e(x),e(q,null,{default:s(()=>[o("div",null,[o("div",null,[(d(!0),m(k,null,C(l.comments,(i,p)=>(d(),m("div",{key:p,class:J({"admin-comment":i.user_type==1,"user-comment":i.user_type==0})},[o("div",ve,[o("p",null,'" '+u(i.content)+' "',1),e(v,{class:"justify-space-between mx-2 mb-2"},{default:s(()=>[o("small",null,u(i.name)+" - "+u(i.position),1),o("small",null,u(n.formatDate(i.created_at)),1)]),_:2},1024)]),e(Z,{transition:"scale-transition"},{activator:s(({props:b})=>[e(_,$(b,{class:"ellipsis-icon"}),{default:s(()=>[c("mdi-dots-vertical")]),_:2},1040)]),default:s(()=>[e(ee,null,{default:s(()=>[e(P,{color:"primary",onClick:b=>n.popupEdit(i)},{prepend:s(()=>[e(_,{icon:"mdi-edit"})]),default:s(()=>[e(B,null,{default:s(()=>[c(" edit")]),_:1})]),_:2},1032,["onClick"]),e(P,{color:"primary",onClick:b=>n.deleteComment(i.id)},{prepend:s(()=>[e(_,{icon:"mdi-trash"})]),default:s(()=>[e(B,null,{default:s(()=>[c(" hapus")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)],2))),128))])])]),_:1}),e(te,{modelValue:l.edit,"onUpdate:modelValue":a[3]||(a[3]=i=>l.edit=i),width:"auto"},{default:s(()=>[e(V,null,{title:s(()=>[c(" Update comment ")]),text:s(()=>[e(D,{onSubmit:T(n.updateComment,["prevent"])},{default:s(()=>[e(v,{align:"center",justify:"center"},{default:s(()=>[e(y,{md:"10",cols:"10"},{default:s(()=>[e(I,{"bg-color":"grey-lighten-2",color:"cyan",modelValue:l.dataForm.descupdate,"onUpdate:modelValue":a[2]||(a[2]=i=>l.dataForm.descupdate=i)},null,8,["modelValue"])]),_:1}),e(y,{md:"2",cols:"2"},{default:s(()=>[e(S,{density:"compact",icon:"mdi-note-plus",type:"submit"})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),_:1})]),_:1})])}const Re=O(oe,[["render",Fe],["__scopeId","data-v-91795b78"]]);export{Re as default};
