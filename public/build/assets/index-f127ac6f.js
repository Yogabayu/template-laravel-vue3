import{m}from"./axios-42ffa80f.js";import{S as d,o as f,c as g,a as o,w as s,e as p,b as h,d as w,V as c}from"./main-fe8c19d8.js";import{_ as V}from"./_plugin-vue_export-helper-c27b6911.js";import{V as F,a as y,e as P,c as _,d as l}from"./VRow-6249aab9.js";import{V as x,a as n}from"./VTextField-9bcc7120.js";import{V as T}from"./VFileInput-30c6223f.js";import"./index-12d54a3b.js";import"./VImg-427b7462.js";import"./VChip-f2b5c1c5.js";const b={data(){return{dataForm:{name:"",email:"",password:null,nik:null,uuid:null,photo:null},displayPhoto:null,isPasswordVisible:!1}},methods:{cekForm(){console.log(this.dataForm)},handlePhotoChange(e){const a=e.target.files[0];a&&["image/jpeg","image/png"].includes(a.type)?this.dataForm.photo=a:(this.$showToast("error","Error","Hanya file JPEG atau PNG yang diizinkan."),e.target.value=null)},async updateUserProfile(){try{const e=new FormData;e.append("uuid",this.dataForm.uuid),e.append("name",this.dataForm.name),e.append("email",this.dataForm.email),e.append("password",this.dataForm.password),e.append("nik",this.dataForm.nik),this.dataForm.photo&&e.append("photo",this.dataForm.photo),e.append("_method","PUT");const a=await m.post("/updateUserProfile",e,{headers:{"Content-Type":"multipart/form-data"}});a.status===200?this.dataForm.password==null?(this.getUserProfile(),this.$showToast("success","Success",a.data.message),console.log(this.dataForm.password)):this.logout():this.$showToast("error","Sorry",a.data.message)}catch(e){this.$showToast("error","Sorry",e.response.data.message)}},async getUserProfile(){try{const e=await m.get("/userProfile");e.status===200?(this.dataForm.name=e.data.data.name,this.dataForm.email=e.data.data.email,this.dataForm.nik=e.data.data.nik,this.dataForm.uuid=e.data.data.uuid,this.displayPhoto=`http://localhost:8000/user/photo/${e.data.data.photo}`):this.$showToast("error","Sorry",e.data.data.message)}catch(e){this.$showToast("error","Sorry",e.data.data.message)}},async logout(){m.post("/logout").then(e=>{localStorage.removeItem("userData"),localStorage.removeItem("userToken"),d.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:i=>{i.addEventListener("mouseenter",d.stopTimer),i.addEventListener("mouseleave",d.resumeTimer)}}).fire({icon:"success",title:"Yeay",text:"Berhasil logout"}),this.$router.push("/login")}).catch(e=>{console.error("Error during logout:",e),d.fire({icon:"error",title:"Oops...",text:"Terjadi kesalahan saat melakukan logout"})})}},mounted(){this.getUserProfile()}},k={class:"profile-container"},U=["src"];function v(e,a,i,C,t,u){return f(),g("div",null,[o(F,{class:"auth-card pa-4 pt-5"},{default:s(()=>[o(y,{class:"align-left"},{default:s(()=>[o(P,{class:"text-2xl font-weight-bold"},{default:s(()=>[p(" User Profile ")]),_:1})]),_:1}),h("div",k,[h("img",{class:"profile-image",src:t.displayPhoto,alt:"User Profile Photo"},null,8,U)]),o(x,{class:"mt-6",onSubmit:w(u.updateUserProfile,["prevent"])},{default:s(()=>[o(_,null,{default:s(()=>[o(l,{md:"6",cols:"12"},{default:s(()=>[o(n,{placeholder:"John",label:"Nama",modelValue:t.dataForm.name,"onUpdate:modelValue":a[0]||(a[0]=r=>t.dataForm.name=r),autofocus:""},null,8,["modelValue"])]),_:1}),o(l,{cols:"12",md:"6"},{default:s(()=>[o(n,{label:"E-mail",placeholder:"johndoe@gmail.com",type:"email",modelValue:t.dataForm.email,"onUpdate:modelValue":a[1]||(a[1]=r=>t.dataForm.email=r)},null,8,["modelValue"])]),_:1}),o(l,{cols:"12",md:"6"},{default:s(()=>[o(n,{label:"NIK",modelValue:t.dataForm.nik,"onUpdate:modelValue":a[2]||(a[2]=r=>t.dataForm.nik=r)},null,8,["modelValue"])]),_:1}),o(l,{cols:"12",md:"6"},{default:s(()=>[o(n,{modelValue:t.dataForm.password,"onUpdate:modelValue":a[3]||(a[3]=r=>t.dataForm.password=r),label:"Password",placeholder:"············",type:t.isPasswordVisible?"text":"password","append-inner-icon":t.isPasswordVisible?"bx-hide":"bx-show","onClick:appendInner":a[4]||(a[4]=r=>t.isPasswordVisible=!t.isPasswordVisible)},null,8,["modelValue","type","append-inner-icon"])]),_:1}),o(l,{cols:"12",md:"6"},{default:s(()=>[o(T,{accept:"image/png, image/jpeg, image/bmp",placeholder:"Pick an photo","prepend-icon":"mdi-camera",label:"Photo",onChange:u.handlePhotoChange},null,8,["onChange"])]),_:1}),o(l,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:s(()=>[o(c,{type:"submit"},{default:s(()=>[p("Update changes")]),_:1}),o(c,{color:"secondary",variant:"tonal",type:"reset"},{default:s(()=>[p(" Reset ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})])}const G=V(b,[["render",v]]);export{G as default};
