import{m as f}from"./VAvatar-0e3794e8.js";import{O as U,P as L,Q as N,R as M,S as R,T as j,U as A,W as E,X as G,a as e,Y as H,o as m,c,w as a,b as o,i as _,e as h,t as n,f as g,G as F,F as C,d as T,V as S,D as K,M as O,H as z,I as J}from"./main-13669c19.js";import{_ as Q}from"./_plugin-vue_export-helper-c27b6911.js";import{V as w,a as W,c as b,b as X}from"./VCard-7bbc64c9.js";import{d as Y,V as $,a as q,b as x,c as D}from"./VMenu-f70ca5e3.js";import{a as Z,V as ee}from"./VChip-5568f700.js";import{V as I}from"./VSpacer-a110b61e.js";import{V as P}from"./VForm-d81e6643.js";import{V as v,a as y}from"./VRow-4da1e996.js";import{V as B}from"./VTextarea-0ddc0a36.js";import{V as te}from"./VDialog-e0694243.js";import"./VImg-be343280.js";import"./index-d00cb414.js";import"./VOverlay-4a465866.js";import"./dialog-transition-89f9a8ec.js";import"./VCounter-33afe4c4.js";const se=U({fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,...L(),...N(),...M(),...R()},"v-table"),ae=j()({name:"VTable",props:se(),setup(t,s){let{slots:r}=s;const{themeClasses:k}=A(t),{densityClasses:l}=E(t);return G(()=>e(t.tag,{class:["v-table",{"v-table--fixed-height":!!t.height,"v-table--fixed-header":t.fixedHeader,"v-table--fixed-footer":t.fixedFooter,"v-table--has-top":!!r.top,"v-table--has-bottom":!!r.bottom,"v-table--hover":t.hover},k.value,l.value,t.class],style:t.style},{default:()=>{var d,i,p;return[(d=r.top)==null?void 0:d.call(r),r.default?e("div",{class:"v-table__wrapper",style:{height:H(t.height)}},[e("table",null,[r.default()])]):(i=r.wrapper)==null?void 0:i.call(r),(p=r.bottom)==null?void 0:p.call(r)]}})),{}}}),oe={data(){return{detail:{},fileId:this.$route.params.fileId,fileUser:this.$userPhotoUrl,filePath:this.$filePath,comments:null,dataForm:{id:null,file_uuid:this.$route.params.fileId,desc:null,descupdate:null},edit:!1}},methods:{goBack(){this.$router.go(-1)},formatDate(t){return new Date(t).toLocaleDateString("id-ID")},async getDetailFile(t){try{const s=await f.get(`/file/${t}`);s.status===200?this.detail=s.data.data:this.$showToast("error","Sorry",s.data.data.message)}catch(s){this.$showToast("error","Sorry",s.response.data.data.message)}},resetForm(){this.dataForm={id:null,file_uuid:this.$route.params.fileId,desc:null,descupdate:null}},async getCommentFile(t){try{const s=await f.get(`/comment/${t}`);this.comments=s.data.data.map(r=>({id:r.uuid,content:r.desc,user_type:r.user.isAdmin,name:r.user.name,position:r.user.position.name,created_at:r.created_at}))}catch(s){const r=s.response&&s.response.data&&s.response.data.message?s.response.data.message:"Gagal login. Silakan coba lagi.";this.$showToast("error","Sorry",r)}},async insertCommentar(){try{this.dataForm.desc===null&&this.$showToast("error","Sorry","komentar kosong");const t=new FormData;t.append("file_uuid",this.dataForm.file_uuid),t.append("desc",this.dataForm.desc),t.append("_method","POST");const s=await f.post("/comment",t);s.status===200?(this.resetForm(),this.getCommentFile(this.fileId),this.$showToast("success","Success",s.data.message)):this.$showToast("error","Sorry",s.data.message)}catch(t){this.$showToast("error","Sorry",t.response.data.message)}},async deleteComment(t){try{if(!window.confirm("Apakah Anda yakin ingin menghapus comment?"))return;const r=await f.delete(`/comment/${t}`);r.status===200?(this.getCommentFile(this.fileId),this.$showToast("success","Berhasil",r.data.message)):this.$showToast("error","Sorry",r.data.message)}catch(s){this.$showToast("error","Sorry",s.response.data.message)}},popupEdit(t){this.dataForm.id=t.id,this.dataForm.descupdate=t.content,this.edit=!0},async updateComment(){try{const t=new FormData;t.append("desc",this.dataForm.descupdate),t.append("_method","PUT");const s=await f.post(`/comment/${this.dataForm.id}`,t);s.status===200?(this.resetForm(),this.getCommentFile(this.fileId),this.edit=!1,this.$showToast("success","Success",s.data.message)):this.$showToast("error","Sorry",s.data.message)}catch(t){this.$showToast("error","Sorry",t.response.data.message)}}},mounted(){this.getDetailFile(this.fileId),this.getCommentFile(this.fileId)}},u=t=>(z("data-v-d73cadfe"),t=t(),J(),t),re=u(()=>o("td",null,"Nama File",-1)),le=u(()=>o("td",null,":",-1)),ie=u(()=>o("td",null,"Deskripsi Singkat",-1)),de=u(()=>o("td",null,":",-1)),ne=u(()=>o("td",null,"Keyword",-1)),ue=u(()=>o("td",null,":",-1)),me={key:0},ce=u(()=>o("td",null,"Pengunggah",-1)),he=u(()=>o("td",null,":",-1)),pe={class:"row d-flex align-center"},fe={key:0,class:"player-wrapper"},_e=["src","alt"],ge={key:1},ye={key:1},Ve=u(()=>o("td",null,"Jabatan",-1)),we=u(()=>o("td",null,":",-1)),be={class:"row d-flex align-center"},ve=["src"],ke={class:"mt-3"},Fe={class:"comment-content"};function Ce(t,s,r,k,l,d){return m(),c("div",null,[e(w,{class:"auth-card pa-4 pt-5"},{default:a(()=>[e(W,{class:"align-left"},{default:a(()=>[o("span",{color:"primary",onClick:s[0]||(s[0]=(...i)=>d.goBack&&d.goBack(...i)),style:{cursor:"pointer"}},[e(_,{icon:"bx-arrow-back",color:"primary",tag:"back",start:""}),h(" Back ")]),e(b,{class:"text-2xl font-weight-bold"},{default:a(()=>[h(" Detail "+n(l.detail.name??"-"),1)]),_:1}),e(Y,{inset:""}),e(ae,null,{default:a(()=>[o("tbody",null,[o("tr",null,[re,le,o("td",null,n(l.detail.name),1)]),o("tr",null,[ie,de,o("td",null,n(l.detail.summary),1)]),o("tr",null,[ne,ue,o("td",null,n(l.detail.keywords),1)]),l.detail.author?(m(),c("tr",me,[ce,he,o("td",null,[o("div",pe,[l.detail.author.photo?(m(),c("div",fe,[o("img",{class:"avator",src:l.fileUser+l.detail.author.photo,alt:l.detail.name,width:60},null,8,_e)])):g("",!0),l.detail.author.name?(m(),c("span",ge,n(l.detail.author.name),1)):g("",!0)])])])):g("",!0),l.detail.positions?(m(),c("tr",ye,[Ve,we,o("td",null,[o("div",be,[e(Z,{"selected-class":"text-primary",column:""},{default:a(()=>[(m(!0),c(F,null,C(l.detail.positions,(i,p)=>(m(),c("div",{key:p},[e(ee,{style:{color:"rgb(6, 84, 107)"}},{default:a(()=>[h(n(i.name),1)]),_:2},1024)]))),128))]),_:1})])])])):g("",!0)])]),_:1}),o("div",null,[o("iframe",{width:"100%",height:"500px",src:l.filePath+l.detail.path,frameborder:"0",allowfullscreen:""},null,8,ve)]),e(I),o("div",ke,[e(w,{class:"mx-auto"},{default:a(()=>[e(b,null,{default:a(()=>[h(" Komentar ")]),_:1}),e(b,null,{default:a(()=>[e(P,{onSubmit:T(d.insertCommentar,["prevent"])},{default:a(()=>[e(v,{align:"center",justify:"center"},{default:a(()=>[e(y,{md:"10",cols:"10"},{default:a(()=>[e(B,{"bg-color":"grey-lighten-2",color:"cyan",modelValue:l.dataForm.desc,"onUpdate:modelValue":s[1]||(s[1]=i=>l.dataForm.desc=i)},null,8,["modelValue"])]),_:1}),e(y,{md:"2",cols:"2"},{default:a(()=>[e(S,{density:"compact",icon:"mdi-note-plus",type:"submit"})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e(I),e(X,null,{default:a(()=>[o("div",null,[o("div",null,[(m(!0),c(F,null,C(l.comments,(i,p)=>(m(),c("div",{key:p,class:K({"admin-comment":i.user_type==1,"user-comment":i.user_type==0})},[o("div",Fe,[o("p",null,'" '+n(i.content)+' "',1),e(v,{class:"justify-space-between mx-2 mb-2"},{default:a(()=>[o("small",null,n(i.name)+" - "+n(i.position),1),o("small",null,n(d.formatDate(i.created_at)),1)]),_:2},1024)]),e($,{transition:"scale-transition"},{activator:a(({props:V})=>[e(_,O(V,{class:"ellipsis-icon"}),{default:a(()=>[h("mdi-dots-vertical")]),_:2},1040)]),default:a(()=>[e(q,null,{default:a(()=>[e(x,{color:"primary",onClick:V=>d.popupEdit(i)},{prepend:a(()=>[e(_,{icon:"mdi-edit"})]),default:a(()=>[e(D,null,{default:a(()=>[h(" edit")]),_:1})]),_:2},1032,["onClick"]),e(x,{color:"primary",onClick:V=>d.deleteComment(i.id)},{prepend:a(()=>[e(_,{icon:"mdi-trash"})]),default:a(()=>[e(D,null,{default:a(()=>[h(" hapus")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)],2))),128))])])]),_:1}),e(te,{modelValue:l.edit,"onUpdate:modelValue":s[3]||(s[3]=i=>l.edit=i),width:"auto"},{default:a(()=>[e(w,null,{title:a(()=>[h(" Update comment ")]),text:a(()=>[e(P,{onSubmit:T(d.updateComment,["prevent"])},{default:a(()=>[e(v,{align:"center",justify:"center"},{default:a(()=>[e(y,{md:"10",cols:"10"},{default:a(()=>[e(B,{"bg-color":"grey-lighten-2",color:"cyan",modelValue:l.dataForm.descupdate,"onUpdate:modelValue":s[2]||(s[2]=i=>l.dataForm.descupdate=i)},null,8,["modelValue"])]),_:1}),e(y,{md:"2",cols:"2"},{default:a(()=>[e(S,{density:"compact",icon:"mdi-note-plus",type:"submit"})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),_:1})]),_:1})])}const He=Q(oe,[["render",Ce],["__scopeId","data-v-d73cadfe"]]);export{He as default};
